<!DOCTYPE html>
<html dir="ltr" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0" />
    <title>Stencil Component Starter</title>

    <script type="module" src="/build/stencil-components.esm.js"></script>
    <script nomodule src="/build/stencil-components.js"></script>
  </head>
  <body>
    <my-component first="Stencil" middle="'Don't call me a framework'" last="JS"></my-component>

  <pv-legend-component
      legend-title="Chart Legend"
      items='[{"label": "Series 1", "color": "#ff0000"}, {"label": "Series 2", "color": "#00ff00"}, {"label": "Series 3", "color": "#0000ff"}]'>
    </pv-legend-component>

    <div class="controls" style="margin-bottom: 20px; text-align: right;">
      <button id="add-btn" style="
        padding: 8px 16px;
        background-color: #0070f3;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      ">Add New User</button>
    </div>

    <pv-table-component id="demo-table" enable-row-selection="true"></pv-table-component>

    <script>
      const table = document.getElementById('demo-table');
      const addBtn = document.getElementById('add-btn');

      let tableData = Array.from({ length: 15 }, (_, i) => ({
        id: i + 1,
        name: `User ${i + 1}`,
        role: ['Admin', 'Editor', 'User', 'Guest'][i % 4],
        status: ['Active', 'Inactive', 'Pending'][i % 3]
      }));

      table.columns = [
        { key: 'id', label: 'ID' },
        { key: 'name', label: 'Name' },
        { key: 'role', label: 'Role' },
        { key: 'status', label: 'Status' }
      ];
      
      table.data = tableData;
      table.itemsPerPage = 5;

      // Handle Add
      addBtn.addEventListener('click', () => {
        const newId = Math.max(...tableData.map(u => u.id), 0) + 1;
        const newUser = {
          id: newId,
          name: `New User ${newId}`,
          role: 'Guest',
          status: 'Pending'
        };
        tableData = [newUser, ...tableData];
        table.data = tableData;
      });

      // Handle Delete (listening to custom event)
      table.addEventListener('actionDelete', (e) => {
        const rowToDelete = e.detail;
        if(confirm(`Delete user ${rowToDelete.name}?`)) {
            tableData = tableData.filter(item => item.id !== rowToDelete.id);
            table.data = tableData;
        }
      });
    </script>
  </body>
</html>
